# ユーザー設定画面の項目定義

## 1. 概要

ユーザーは以下の2種類のログイン方法を利用できる。
- OIDCログイン（Google/GitHub）
- メールアドレス+パスワードによるログイン

これらのログイン方法が組み合わさることで、以下の3つのユーザー状態が存在する。
| ユーザー状態 | メールアドレス | パスワード | 外部認証連携情報 |
|:-----------|:--------|:--------|:-----|
| 状態1 | 設定済み | 設定済み | 未設定 |
| 状態2 | 未設定 | 未設定 | 設定済み |
| 状態3 | 設定済み | 設定済み | 設定済み |

- 状態1は以下の場合に
    - メールアドレス+パスワードによるユーザー登録をした
    - メールアドレス+パスワードによるユーザー登録 かつ 外部認証連携をした状態で外部認証連携を解除した
- 状態2は以下の場合に
    - 外部認証連携をしたがメールアドレスが取得できなかった(Githubでメールアドレスが未設定や非公開になっている場合に起こりうる)
- 状態3は以下の場合に
    - メールアドレス+パスワードによるユーザー登録 かつ 外部認証連携をした

## 2. 画面項目一覧

| No. | 項目名 | コントロールタイプ | 説明 |
|:----|:------|:--------------|:-----|
| 1 | ユーザー名 | テキストフィールド | ユーザー表示名の設定 |
| 2 | メールアドレス | テキストフィールド | ユーザーのメールアドレス表示 |
| 3 | プロフィール画像 | 画像 | ユーザーのプロフィール画像の表示・設定 |
| 4 | 二段階認証設定 | トグル | 二段階認証の有効・無効の切り替え |
| 5 | メールアドレス+パスワード設定状態表示 | テキスト+リンク | 設定状態の表示と設定/変更機能へのリンク |
| 6 | 外部連携解除ボタン | ボタン | OIDCによる外部連携の解除機能 |

## 3. 状態別の表示制御

### 3.1 ユーザー名

| ユーザー状態 | 表示状態 | 操作可否 | 備考 |
|:-----------|:--------|:--------|:-----|
| 状態1 | 表示 | 操作可 | |
| 状態2 | 表示 | 操作可 | |
| 状態3 | 表示 | 操作可 | |

### 3.2 メールアドレス

| ユーザー状態 | 表示状態 | 操作可否 | 備考 |
|:-----------|:--------|:--------|:-----|
| 状態1 | 表示 | 操作不可 | 読取専用 |
| 状態2 | 表示 | 操作不可 | 読取専用、項目5のリンクからのみ設定可能 |
| 状態3 | 表示 | 操作不可 | 読取専用 |

### 3.3 プロフィール画像

| ユーザー状態 | 表示状態 | 操作可否 | 備考 |
|:-----------|:--------|:--------|:-----|
| 状態1 | 表示 | 操作可 | |
| 状態2 | 表示 | 操作可 | |
| 状態3 | 表示 | 操作可 | |

### 3.4 二段階認証設定

| ユーザー状態 | 表示状態 | 操作可否 | 備考 |
|:-----------|:--------|:--------|:-----|
| 状態1 | 表示 | 操作可 | ON/OFF切替可能<br>※ただし、OIDCログインの場合は二段階認証を発生させない |
| 状態2 | 表示 | 操作不可 | 非活性状態 |
| 状態3 | 表示 | 操作可 | ON/OFF切替可能<br>※ただし、OIDCログインの場合は二段階認証を発生させない |

### 3.5 メールアドレス+パスワード設定状態表示

| ユーザー状態 | 表示内容 | 操作可否 | 備考 |
|:-----------|:--------|:--------|:-----|
| 状態1 | 「メールアドレス+パスワードは設定済みです。パスワードの変更は[こちら]」 | リンク操作可 | リンククリックでパスワード変更画面へ |
| 状態2 | 「メールアドレス+パスワードが未設定です。設定は[こちら]」 | リンク操作可 | リンククリックで設定画面へ |
| 状態3 | 「メールアドレス+パスワードは設定済みです。パスワードの変更は[こちら]」 | リンク操作可 | リンククリックでパスワード変更画面へ |

### 3.6 外部連携解除ボタン

| ユーザー状態 | 表示状態 | 操作可否 | 備考 |
|:-----------|:--------|:--------|:-----|
| 状態1 | 非表示 | 操作不可 | 外部連携が存在しないため表示しない |
| 状態2 | 表示 | 操作不可 | 非活性状態、上部に「メールアドレスとパスワードが未設定のため、連携を解除できません」を表示 |
| 状態3 | 表示 | 操作可 | ボタン押下で連携を解除し状態1に移行<br>※GoogleとGitHub両方連携済みの場合は1つ解除しても状態3のまま |
